* Torrent Mode
[[https://melpa.org/#/torrent-mode][file:https://melpa.org/packages/torrent-mode-badge.svg]]

This is a minor mode based on =tablist-mode= to view contents of a torrent file.

** Setup
#+begin_src emacs-lisp
(use-package torrent-mode
  :custom
  ;; function that starts download for marked files
  (torrent-mode-download-function #'torrent-mode-download-aria2)

  ;; no selected files means download all
  (torrent-mode-none-marked-means-all t))
#+end_src

** aria2 integration
#+begin_src emacs-lisp
(defun aria2-format-select-file (files)
  (mapconcat (lambda (idx) (number-to-string (1+ idx))) files ","))

(defun torrent-mode-download-aria2 (fn &rest selected)
  (let ((dir (read-directory-name "Directory: " aria2-download-directory nil t)))
    (aria2-downloads-list)
    (addTorrent aria2--cc fn
                :select-file (aria2-format-select-file selected)
                :dir (expand-file-name dir))))
#+end_src

Mark files (=*= or =m=) and press =D= to start download.
